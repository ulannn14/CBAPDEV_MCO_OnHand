{{#> layout title="Messages"}}

  {{#*inline "headScripts"}}
    <script>window.APP_ROLE = 'provider';</script>
    <script src="/js/messages.js" defer></script>
    <script src="/js/popup.js"></script>
    <script src="/js/dropdown-profile.js"></script>
  {{/inline}}

  <aside class="conversations-col">
    <div class="convo-list" id="convoList"></div>
  </aside>

  <section class="thread-col">
    <div class="thread-top">
      <button id="makeOfferBtn" class="make-offer-btn">Check Offer</button>
    </div>

    <div id="messagesArea" class="messages-area">
      <div class="placeholder">Select a conversation to start</div>
    </div>

    <div class="composer">
      <label class="attach-label" title="Attach image">
        <input type="file" id="attachFile" accept="image/*" multiple hidden>
        <i class="fa-solid fa-image attach-icon"></i>
      </label>

      <div id="imagePreview" class="image-preview" aria-live="polite"></div>

      <input id="messageInput" class="message-input" placeholder="Type message here..." autocomplete="off">
      <button id="sendBtn" class="send-btn">Send</button>
    </div>
  </section>

  <div id="offerModal" class="modal" aria-hidden="true">
    <div class="modal-inner" role="dialog" aria-modal="true" aria-labelledby="offerTitle">
      <header class="modal-header">
        <h3 id="offerTitle">Check Offer</h3>
        <button id="closeOffer" class="modal-close" aria-label="Close">✕</button>
      </header>

      <form id="offerForm" class="offer-form">
        <label style="display:block; margin-bottom:6px;">
          Price
          <div id="offerPriceDisplay"
              class="offer-price-display"
              role="status"
              aria-live="polite"
              data-value="0"
              style="font-size:20px; font-weight:700; margin-top:6px;">
            ₱10,000.00
          </div>
        </label>

        <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end;">
          <button type="button" id="offerDecline" class="btn-secondary">Decline</button>
          <button type="submit" id="offerAccept" class="btn-primary">Accept</button>
        </div>
      </form>
    </div>
  </div>

{{/layout}}