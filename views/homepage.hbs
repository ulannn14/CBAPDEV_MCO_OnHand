<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home | OnHand</title>
  <link rel="icon" href="/images/icon.png" type="image/png">

  <!-- Global Styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/homepage.css">
  <link rel="stylesheet" href="/css/popups.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

{{> header}}

<!-- Search Section -->
<section id="search-section">
  <form id="searchForm" method="GET" action="/search">
    <input type="text" name="service" placeholder="{{#if user.isProvider}}Find a request{{else}}Find a service{{/if}}" class="search-input">

    <select name="urgency" class="search-select">
      <option value="">Urgency</option>
      <option value="urgent">Urgent</option>
      <option value="non-urgent">Non-Urgent</option>
    </select>

    <input type="text" name="minPrice" placeholder="Min ₱" class="search-input price">
    <input type="text" name="maxPrice" placeholder="Max ₱" class="search-input price">
    <input type="text" name="location" placeholder="Location" class="search-input">

    <button type="submit" class="search-btn">Search</button>
  </form>
</section>

{{!-- Customer view --}}
{{#unless user.isProvider}}

  <!-- Categories Section -->
  <section class="categories">
    <h2>Service Categories</h2>
    <div class="category-list">
      {{#each categories}}
        <div class="category">
          <img src="{{this.image}}" alt="{{this.name}}">
          <h3>{{this.name}}</h3>
        </div>
      {{/each}}
    </div>
  </section>

  <!-- Services Near You -->
  <section class="services-near-you">
    <h2>Services Near You</h2>
    <div class="services-grid">
      {{#each services}}
        {{> serviceCard this isOwner=false}}
      {{/each}}
    </div>
  </section>

{{/unless}}

{{!-- Provider view --}}
{{#if user.isProvider}}

  <!-- Customers Near You -->
  <section class="services-near-you">
    <h2>Customers Near You</h2>
    <div class="services-grid">
      {{#each customers}}
        {{> serviceCard this isOwner=false}}
      {{/each}}
    </div>
  </section>

{{/if}}

<!-- Floating Button for Create Post  -->
<div class="floating-report">
  <i class="fa-solid fa-clipboard-list"></i>
</div>

<!-- Create Post -->
<div class="post-popup" id="postPopup" style="display: none;">
  <div class="popup-content">
    <h3>Create a Post</h3>

    <form id="createPostForm" enctype="multipart/form-data">
      <textarea 
        placeholder="What do you need help with?" 
        class="post-text" 
        id="postText"
        required></textarea>

      <label class="popup-label">Need:</label>
      <select id="postNeed" class="popup-input" required>
        <option value="">Select Service Type</option>
        {{#each categories}}
          <option value="{{this.name}}">{{this.name}}</option>
        {{/each}}
      </select>

      <label class="popup-label">Location:</label>
      <input 
        type="text" 
        id="postLocation" 
        class="popup-input" 
        placeholder="Enter your city or area" 
        required>

      <div class="price-range">
        <div>
          <label class="popup-label">Min Price (₱):</label>
          <input type="number" id="minPrice" class="popup-input" required>
        </div>
        <div>
          <label class="popup-label">Max Price (₱):</label>
          <input type="number" id="maxPrice" class="popup-input" required>
        </div>
      </div>

      <label class="popup-label">Upload Images:</label>
      <input type="file" id="postImages" accept="image/*" multiple class="popup-input">
      <div class="image-preview" id="imagePreview"></div>

      <div class="popup-actions">
        <button type="button" class="btn-cancel" id="cancelPost">Cancel</button>
        <button type="submit" class="btn-post">Post</button>
      </div>
    </form>
  </div>
</div>

 <!-- Scripts -->
  <script src="/js/popup.js"></script>
</body>
</html>