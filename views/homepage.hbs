<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home | OnHand</title>

  <link rel="stylesheet" href="/css/homepage.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/popups.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <script src="/js/popup.js"></script>
  <script src="/js/dropdown-profile.js"></script>
  <script src="/js/create-post.js"></script>
  
  <link rel="icon" href="/images/icon.png" type="image/png">
</head>
<body>

  {{> header}}

  <!-- Search Section -->
  <section id="search-section">
    <form id="searchForm" method="GET" action="/search">
      <input type="text" name="service" placeholder="Find a service" class="search-input">

      <select name="urgency" class="search-select">
        <option value="">Urgency</option>
        <option value="urgent">Urgent</option>
        <option value="normal">Normal</option>
      </select>

      <input type="text" name="minPrice" placeholder="Min ₱" class="search-input price">
      <input type="text" name="maxPrice" placeholder="Max ₱" class="search-input price">

      <select name="location" class="search-select">
        <option value="">Location</option>
        <option value="Manila">Manila</option>
        <option value="Quezon City">Quezon City</option>
        <option value="Makati">Makati</option>
        <option value="Taguig">Taguig</option>    
        <option value="Mandaluyong">Mandaluyong</option>
        <option value="Pasig">Pasig</option>
        <option value="Pasay">Pasay</option>
        <option value="Valenzuela">Valenzuela</option>
        <option value="Caloocan">Caloocan</option>
        <option value="Las Piñas">Las Piñas</option>
        <option value="Muntinlupa">Muntinlupa</option>
        <option value="Parañaque">Parañaque</option>
        <option value="Marikina">Marikina</option>
        <option value="San Juan">San Juan</option>
        <option value="Malabon">Malabon</option>
        <option value="Navotas">Navotas</option>
        <option value="Cavite">Cavite</option>
        <option value="Laguna">Laguna</option>
        <option value="Rizal">Rizal</option>
        <option value="Bulacan">Bulacan</option>
      </select>
      
      <button type="submit" class="search-btn">
        Search <span></span>
      </button>
    </form>
  </section>

  <!-- Categories Section (only show for customers) -->
  {{#unless (eq sessionUser.mode 'provider')}}
  <section class="categories">
    <h2>Service Categories</h2>
    <div class="category-list">

      <a class="category" href="/search?service=plumbing&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/1.png" alt="Plumbing Services">
        <h3>Plumbing Services</h3>
      </a>

      <a class="category" href="/search?service=electrical&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/6.png" alt="Electrical Issues">
        <h3>Electrical Issues</h3>
      </a>

      <a class="category" href="/search?service=roof%20repairs&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/7.png" alt="Roof Repairs">
        <h3>Roof Repairs</h3>
      </a>

      <a class="category" href="/search?service=structural%20repairs&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/2.png" alt="Structural Repairs">
        <h3>Structural Repairs</h3>
      </a>

      <a class="category" href="/search?service=pest%20control&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/5.png" alt="Pest Control">
        <h3>Pest Control</h3>
      </a>

      <a class="category" href="/search?service=hvac%20breakdown&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/4.png" alt="HVAC">
        <h3>HVAC / Appliance Breakdown</h3>
      </a>

      <a class="category" href="/search?service=locksmith&urgency=&minPrice=&maxPrice=&location=">
        <img src="/images/3.png" alt="Locksmith Services">
        <h3>Locksmith Services</h3>
      </a>

    </div>
  </section>
  {{/unless}}


  <!-- Services or Customer Posts Section -->
  <section class="services-near-you">
    <h2>{{#if (eq sessionUser.mode 'provider')}}Customers Near You{{else}}Services Near You{{/if}}</h2>

    <div class="services-grid">
      {{#if posts.length}}
        {{#each posts}}
          {{> serviceCard this}}
        {{/each}}
      {{else}}
        <p class="no-posts">No available {{#if (eq sessionUser.mode 'provider')}}customer requests{{else}}services{{/if}} near you yet.</p>
      {{/if}}
    </div>
  </section>

  <!-- Floating Button -->
  <div class="floating-report">
    <i class="fa-solid fa-clipboard-list"></i>
  </div>

  <!-- Post Popup -->
  <div class="post-popup" id="postPopup" style="display: none;">
    <div class="popup-content">
      <h3>Create a Post</h3>

      <form id="createPostForm" enctype="multipart/form-data">
        {{!-- Title --}}
        <label class="popup-label">Title:</label>
        <input 
          type="text" 
          id="postTitle" 
          class="popup-input" 
          placeholder="{{#if (eq sessionUser.mode 'provider')}}Enter a short service title (e.g. Reliable Electrician in Makati){{else}}Enter a short title (e.g. Need help fixing a leaky pipe){{/if}}" 
          required>

        {{!-- Description / Main Textarea --}}
        <label class="popup-label">Description:</label>
        <textarea 
          placeholder="{{#if (eq sessionUser.mode 'provider')}}Describe your service...{{else}}What do you need help with?{{/if}}" 
          class="post-text" 
          id="postText"
          required></textarea>

        {{!-- Customer Fields --}}
        {{#unless (eq sessionUser.mode 'provider')}}
          <label class="popup-label">Need:</label>
          <select id="postNeed" class="popup-input" required>
            <option value="">Select Service Type</option>
            <option value="Plumbing">Plumbing</option>
            <option value="Electrical">Electrical</option>
            <option value="Pest Control">Pest Control</option>
            <option value="Roof Repair">Roof Repair</option>
            <option value="Locksmith">Locksmith</option>
          </select>

          <label class="popup-label">Urgency:</label>
          <select id="postUrgency" class="popup-input" required>
            <option value="">Select urgency</option>
            <option value="Urgent">Urgent</option>
            <option value="Non-Urgent">Non-Urgent</option>
          </select>

          <label class="popup-label">Location:</label>
          <input 
            type="text" 
            id="postLocation" 
            class="popup-input" 
            placeholder="Enter your city or area" 
            required>

        {{!-- Provider Fields --}}
        {{else}}
          <label class="popup-label">Service Type:</label>
          <select id="postServiceType" class="popup-input" required>
            <option value="">Select Service</option>
            <option value="Plumbing">Plumbing</option>
            <option value="Electrical">Electrical</option>
            <option value="Pest Control">Pest Control</option>
            <option value="Roof Repair">Roof Repair</option>
            <option value="Locksmith">Locksmith</option>
          </select>

          <label class="popup-label">Location:</label>
          <input 
            type="text" 
            id="postLocation" 
            class="popup-input" 
            placeholder="Enter your service area"
            required>
        {{/unless}}

        {{!-- Price Range --}}
        <div class="price-range">
          <div>
            <label class="popup-label">Min Price (₱):</label>
            <input type="number" id="minPrice" class="popup-input" required>
          </div>
          <div>
            <label class="popup-label">Max Price (₱):</label>
            <input type="number" id="maxPrice" class="popup-input" required>
          </div>
        </div>

        <label class="popup-label">Upload Images:</label>
        <input type="file" id="postImages" accept="image/*" multiple class="popup-input">

        <div class="image-preview" id="imagePreview"></div>

        <div class="popup-actions">
          <button type="button" class="btn-cancel" id="cancelPost">Cancel</button>
          <button type="submit" class="btn-post">Post</button>
        </div>
      </form>
    </div>
  </div>
</body>
</html>
