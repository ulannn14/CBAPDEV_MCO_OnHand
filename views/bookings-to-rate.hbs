<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bookings | OnHand</title>

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/bookings.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="/js/bookings-to-rate.js"></script>
  <link rel="icon" href="/images/icon.png" type="image/png">
</head>

<body>

  {{> header}}

  <div class="bookings-container">

    <div class="booking-tabs">
      <a href="/bookings/ongoing" class="{{#if (eq currentTab 'ongoing')}}active{{/if}}">Ongoing</a>
      <a href="/bookings/to-rate" class="{{#if (eq currentTab 'to-rate')}}active{{/if}}">To Rate</a>
      <a href="/bookings/completed" class="{{#if (eq currentTab 'completed')}}active{{/if}}">Completed</a>
    </div>

    <div class="booking-list">
      {{#if bookings.length}}
        {{#each bookings}}
          <div class="booking-card">

            <div class="booking-left">
              <div class="profile-row">
                <a href="/profile/{{username}}" class="profile-link" aria-label="View profile of {{clientName}}">
                  <img src="{{image}}" alt="{{clientName}}" class="profile-pic">
                </a>
                <div class="booking-info">
                  <h3 class="client-name">
                    <a href="/profile/{{username}}" class="profile-link">{{clientName}}</a>
                  </h3>
                  <div class="need-wrapper">
                    <p class="need-label">
                      {{#if (eq ../sessionUser.mode "provider")}}
                        Looking for:
                      {{else}}
                        Offering:
                      {{/if}}
                    </p>
                    <span class="service-type">{{serviceType}}</span>
                  </div>
                </div>
              </div>

              <hr class="divider">
              <p class="location"><i class="fa-solid fa-location-dot"></i> {{location}}</p>
            </div>

            <div class="divider-vertical"></div>

            <div class="booking-right">

              <div class="agreed-price">
                <strong>Agreed Price:</strong>
                <p class="price">â‚±{{price}}</p>
              </div>

              <div class="stars rating-stars">
                {{#times 5}}
                  <i class="fa-regular fa-star" data-value="{{this}}"></i>
                {{/times}}
              </div>

              <p class="status rate-text">Click to rate this service</p>

              <form method="POST" action="/postRating" class="rating-form">
                <input type="hidden" name="bookingId" value="{{bookingId}}">
                <input type="hidden" name="stars" class="rating-value">

                <!-- Review textarea -->
                <textarea name="review" class="review-box" placeholder="Write your review..." style="display:none;"></textarea>

                <!-- Confirm and Cancel buttons -->
                <button type="submit" class="confirm-btn" style="display:none;">Confirm Rating</button>
                <button type="button" class="cancel-btn" style="display:none;">Cancel</button>
              </form>

            </div>

          </div>
        {{/each}}
      {{else}}
        <p class="no-bookings-message">No bookings to rate</p>
      {{/if}}
    </div>
  </div>
</body>
</html>
